from . import SimConcretizationStrategy

class SimConcretizationStrategyKuafffp(SimConcretizationStrategy):
    '''
    Concretization
    '''

    def __init__(self, mapped_addr, length=4096, limit=1, **kwargs):
        super(SimConcretizationStrategyKuafffp, self).__init__(**kwargs)
        self._userspace_map = mapped_addr
        self._length = length
        self._limit = limit

    def _concretize(self, memory, addr):
        #mn,mx = self._range(memory, addr)
        #if mx - mn <= self._limit:
            #return self._eval(memory, addr, self._limit)
        memory.state.add_constraints(addr > self._userspace_map)
        memory.state.add_constraints(addr < self._userspace_map + self._length)
        return self._eval(memory, addr, self._limit)

